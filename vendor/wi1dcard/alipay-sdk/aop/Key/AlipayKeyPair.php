<?php
 namespace Alipay\Key; use Alipay\Exception\AlipayOpenSslException; class AlipayKeyPair { protected $publicKey; protected $privateKey; public static function create($privateKey, $publicKey) { $instance = new static(); $instance->setPrivateKey($privateKey); $instance->setPublicKey($publicKey); return $instance; } public static function generate($configargs = []) { $configargs = array_merge([ 'private_key_bits' => 2048, 'private_key_type' => OPENSSL_KEYTYPE_RSA, ], $configargs); $resource = openssl_pkey_new($configargs); if ($resource === false) { throw new AlipayOpenSslException(); } $instance = new static(); $instance->privateKey = AlipayPrivateKey::fromResource($resource); $instance->publicKey = AlipayPublicKey::create( AlipayPublicKey::toString($resource) ); return $instance; } public function getPrivateKey() { return $this->privateKey; } public function getPublicKey() { return $this->publicKey; } public function setPrivateKey($key) { $this->privateKey = AlipayPrivateKey::create($key); return $this; } public function setPublicKey($key) { $this->publicKey = AlipayPublicKey::create($key); return $this; } } 