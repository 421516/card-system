<?php
interface ILogHandler { public function write($spbfa8f4); } class CLogFileHandler implements ILogHandler { private $handle = null; public function __construct($sp81e22c = '') { $this->handle = @fopen($sp81e22c, 'a'); } public function write($spbfa8f4) { @fwrite($this->handle, $spbfa8f4, 4096); } public function __destruct() { @fclose($this->handle); } } class WxLog { private $handler = null; private $level = 15; private static $instance = null; private function __construct() { } private function __clone() { } public static function Init($sp3e13b8 = null, $spa4e63d = 15) { if (!self::$instance instanceof self) { self::$instance = new self(); self::$instance->__setHandle($sp3e13b8); self::$instance->__setLevel($spa4e63d); } return self::$instance; } private function __setHandle($sp3e13b8) { $this->handler = $sp3e13b8; } private function __setLevel($spa4e63d) { $this->level = $spa4e63d; } public static function DEBUG($spbfa8f4) { } public static function WARN($spbfa8f4) { self::$instance->write(4, $spbfa8f4); } public static function ERROR($spbfa8f4) { $sp46b827 = debug_backtrace(); $sp87c37d = '['; foreach ($sp46b827 as $sp9684a3 => $spc28c86) { if (array_key_exists('file', $spc28c86)) { $sp87c37d .= ',file:' . $spc28c86['file']; } if (array_key_exists('line', $spc28c86)) { $sp87c37d .= ',line:' . $spc28c86['line']; } if (array_key_exists('function', $spc28c86)) { $sp87c37d .= ',function:' . $spc28c86['function']; } } $sp87c37d .= ']'; self::$instance->write(8, $sp87c37d . $spbfa8f4); } public static function INFO($spbfa8f4) { self::$instance->write(2, $spbfa8f4); } private function getLevelStr($spa4e63d) { switch ($spa4e63d) { case 1: return 'debug'; break; case 2: return 'info'; break; case 4: return 'warn'; break; case 8: return 'error'; break; default: } } protected function write($spa4e63d, $spbfa8f4) { if (($spa4e63d & $this->level) == $spa4e63d) { $spbfa8f4 = '[' . date('Y-m-d H:i:s') . '][' . $this->getLevelStr($spa4e63d) . '] ' . $spbfa8f4 . '
'; $this->handler->write($spbfa8f4); } } } $sp0d13f3 = new CLogFileHandler('logs/' . date('Y-m-d') . '.log'); WxLog::Init($sp0d13f3, 15);