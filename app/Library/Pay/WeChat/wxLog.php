<?php
interface ILogHandler { public function write($spcb569a); } class CLogFileHandler implements ILogHandler { private $handle = null; public function __construct($sp4adaf0 = '') { $this->handle = @fopen($sp4adaf0, 'a'); } public function write($spcb569a) { @fwrite($this->handle, $spcb569a, 4096); } public function __destruct() { @fclose($this->handle); } } class WxLog { private $handler = null; private $level = 15; private static $instance = null; private function __construct() { } private function __clone() { } public static function Init($sp4a2982 = null, $sp1a0725 = 15) { if (!self::$instance instanceof self) { self::$instance = new self(); self::$instance->__setHandle($sp4a2982); self::$instance->__setLevel($sp1a0725); } return self::$instance; } private function __setHandle($sp4a2982) { $this->handler = $sp4a2982; } private function __setLevel($sp1a0725) { $this->level = $sp1a0725; } public static function DEBUG($spcb569a) { } public static function WARN($spcb569a) { self::$instance->write(4, $spcb569a); } public static function ERROR($spcb569a) { $sp9a875b = debug_backtrace(); $spf21d37 = '['; foreach ($sp9a875b as $sp63ae76 => $sp679ba2) { if (array_key_exists('file', $sp679ba2)) { $spf21d37 .= ',file:' . $sp679ba2['file']; } if (array_key_exists('line', $sp679ba2)) { $spf21d37 .= ',line:' . $sp679ba2['line']; } if (array_key_exists('function', $sp679ba2)) { $spf21d37 .= ',function:' . $sp679ba2['function']; } } $spf21d37 .= ']'; self::$instance->write(8, $spf21d37 . $spcb569a); } public static function INFO($spcb569a) { self::$instance->write(2, $spcb569a); } private function getLevelStr($sp1a0725) { switch ($sp1a0725) { case 1: return 'debug'; break; case 2: return 'info'; break; case 4: return 'warn'; break; case 8: return 'error'; break; default: } } protected function write($sp1a0725, $spcb569a) { if (($sp1a0725 & $this->level) == $sp1a0725) { $spcb569a = '[' . date('Y-m-d H:i:s') . '][' . $this->getLevelStr($sp1a0725) . '] ' . $spcb569a . '
'; $this->handler->write($spcb569a); } } } $spa904b1 = new CLogFileHandler('logs/' . date('Y-m-d') . '.log'); WxLog::Init($spa904b1, 15);