<?php
interface ILogHandler { public function write($sp55c6db); } class CLogFileHandler implements ILogHandler { private $handle = null; public function __construct($sp88bc5b = '') { $this->handle = fopen($sp88bc5b, 'a'); } public function write($sp55c6db) { fwrite($this->handle, $sp55c6db, 4096); } public function __destruct() { fclose($this->handle); } } class Log { private $handler = null; private $level = 15; private static $instance = null; private function __construct() { } private function __clone() { } public static function Init($sp047ee8 = null, $spb10be8 = 15) { if (!self::$instance instanceof self) { self::$instance = new self(); self::$instance->__setHandle($sp047ee8); self::$instance->__setLevel($spb10be8); } return self::$instance; } private function __setHandle($sp047ee8) { $this->handler = $sp047ee8; } private function __setLevel($spb10be8) { $this->level = $spb10be8; } public static function DEBUG($sp55c6db) { self::$instance->write(1, $sp55c6db); } public static function WARN($sp55c6db) { self::$instance->write(4, $sp55c6db); } public static function ERROR($sp55c6db) { $sp53c22f = debug_backtrace(); $sp1db98f = '['; foreach ($sp53c22f as $spfcd1b0 => $sp1f05d8) { if (array_key_exists('file', $sp1f05d8)) { $sp1db98f .= ',file:' . $sp1f05d8['file']; } if (array_key_exists('line', $sp1f05d8)) { $sp1db98f .= ',line:' . $sp1f05d8['line']; } if (array_key_exists('function', $sp1f05d8)) { $sp1db98f .= ',function:' . $sp1f05d8['function']; } } $sp1db98f .= ']'; self::$instance->write(8, $sp1db98f . $sp55c6db); } public static function INFO($sp55c6db) { self::$instance->write(2, $sp55c6db); } private function getLevelStr($spb10be8) { switch ($spb10be8) { case 1: return 'debug'; break; case 2: return 'info'; break; case 4: return 'warn'; break; case 8: return 'error'; break; default: } } protected function write($spb10be8, $sp55c6db) { if (($spb10be8 & $this->level) == $spb10be8) { $sp55c6db = '[' . date('Y-m-d H:i:s') . '][' . $this->getLevelStr($spb10be8) . '] ' . $sp55c6db . '
'; $this->handler->write($sp55c6db); } } }