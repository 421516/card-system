<?php
require_once 'alipay_core.function.php'; class AlipaySubmit { var $alipay_config; var $alipay_gateway_new = 'https://mapi.alipay.com/gateway.do?'; function __construct($sp60f8fc) { $this->alipay_config = $sp60f8fc; } function AlipaySubmit($sp60f8fc) { $this->__construct($sp60f8fc); } function buildRequestMysign($sp44dd2e) { $sp1f20d7 = createLinkString($sp44dd2e); switch (strtoupper(trim($this->alipay_config['sign_type']))) { case 'MD5': $spc6ce21 = md5Sign($sp1f20d7, $this->alipay_config['key']); break; default: $spc6ce21 = ''; } return $spc6ce21; } function buildRequestPara($spb273dd) { $sp8a8731 = paraFilter($spb273dd); $sp44dd2e = argSort($sp8a8731); $spc6ce21 = $this->buildRequestMysign($sp44dd2e); $sp44dd2e['sign'] = $spc6ce21; $sp44dd2e['sign_type'] = strtoupper(trim($this->alipay_config['sign_type'])); return $sp44dd2e; } function buildRequestParaToString($spb273dd) { $sp7e5ec2 = $this->buildRequestPara($spb273dd); $sp05f6cc = createLinkStringUrlEncode($sp7e5ec2); return $sp05f6cc; } function buildRequestForm($spb273dd, $sp090f2c, $sp11c93a) { $sp7e5ec2 = $this->buildRequestPara($spb273dd); $spae6c66 = '<form id=\'alipaysubmit\' name=\'alipaysubmit\' action=\'' . $this->alipay_gateway_new . '_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])) . '\' method=\'' . $sp090f2c . '\'>'; foreach ($sp7e5ec2 as $spf74fd0 => $sp5d0add) { $spae6c66 .= '<input type=\'hidden\' name=\'' . $spf74fd0 . '\' value=\'' . $sp5d0add . '\'/>'; } $spae6c66 = $spae6c66 . '<input type=\'submit\'  value=\'' . $sp11c93a . '\' style=\'display:none;\'></form>'; $spae6c66 = $spae6c66 . '<script>document.forms[\'alipaysubmit\'].submit();</script>'; return $spae6c66; } function query_timestamp() { $sp11a0e0 = $this->alipay_gateway_new . 'service=query_timestamp&partner=' . trim(strtolower($this->alipay_config['partner'])) . '&_input_charset=' . trim(strtolower($this->alipay_config['input_charset'])); $sp6b8cdc = new DOMDocument(); $sp6b8cdc->load($sp11a0e0); $sp88a076 = $sp6b8cdc->getElementsByTagName('encrypt_key'); $spa656ab = $sp88a076->item(0)->nodeValue; return $spa656ab; } }