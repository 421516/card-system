<?php
function aliqr_encrypt($spdeb044, $spce2759) { $spce2759 = base64_decode($spce2759); $spdeb044 = trim($spdeb044); $spdeb044 = addPKCS7Padding($spdeb044); $sp85dc00 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp317c2f = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $spce2759, $spdeb044, MCRYPT_MODE_CBC); return base64_encode($sp317c2f); } function aliqr_decrypt($spdeb044, $spce2759) { $spdeb044 = base64_decode($spdeb044); $spce2759 = base64_decode($spce2759); $sp85dc00 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp317c2f = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $spce2759, $spdeb044, MCRYPT_MODE_CBC); $sp317c2f = trim($sp317c2f); $sp317c2f = stripPKSC7Padding($sp317c2f); return $sp317c2f; } function addPKCS7Padding($spe6ab09) { $spe6ab09 = trim($spe6ab09); $sp5ee6ed = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $sp94d6d6 = $sp5ee6ed - strlen($spe6ab09) % $sp5ee6ed; if ($sp94d6d6 <= $sp5ee6ed) { $spb9bbcf = chr($sp94d6d6); $spe6ab09 .= str_repeat($spb9bbcf, $sp94d6d6); } return $spe6ab09; } function stripPKSC7Padding($spe6ab09) { $spe6ab09 = trim($spe6ab09); $spb9bbcf = substr($spe6ab09, -1); $sp05f3c8 = ord($spb9bbcf); if ($sp05f3c8 == 62) { return $spe6ab09; } $spe6ab09 = substr($spe6ab09, 0, -$sp05f3c8); return $spe6ab09; }