<?php
function aliqr_encrypt($spf6683b, $spfb9d59) { $spfb9d59 = base64_decode($spfb9d59); $spf6683b = trim($spf6683b); $spf6683b = addPKCS7Padding($spf6683b); $sp8ba572 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $spe7985e = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $spfb9d59, $spf6683b, MCRYPT_MODE_CBC); return base64_encode($spe7985e); } function aliqr_decrypt($spf6683b, $spfb9d59) { $spf6683b = base64_decode($spf6683b); $spfb9d59 = base64_decode($spfb9d59); $sp8ba572 = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $spe7985e = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $spfb9d59, $spf6683b, MCRYPT_MODE_CBC); $spe7985e = trim($spe7985e); $spe7985e = stripPKSC7Padding($spe7985e); return $spe7985e; } function addPKCS7Padding($sp276258) { $sp276258 = trim($sp276258); $sp99a130 = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $sp90fc1b = $sp99a130 - strlen($sp276258) % $sp99a130; if ($sp90fc1b <= $sp99a130) { $spe5f8e5 = chr($sp90fc1b); $sp276258 .= str_repeat($spe5f8e5, $sp90fc1b); } return $sp276258; } function stripPKSC7Padding($sp276258) { $sp276258 = trim($sp276258); $spe5f8e5 = substr($sp276258, -1); $sp5a6595 = ord($spe5f8e5); if ($sp5a6595 == 62) { return $sp276258; } $sp276258 = substr($sp276258, 0, -$sp5a6595); return $sp276258; }