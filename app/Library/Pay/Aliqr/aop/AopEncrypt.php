<?php
function aliqr_encrypt($spb67857, $sp64a7c3) { $sp64a7c3 = base64_decode($sp64a7c3); $spb67857 = trim($spb67857); $spb67857 = addPKCS7Padding($spb67857); $spc2c51b = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp31b9af = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $sp64a7c3, $spb67857, MCRYPT_MODE_CBC); return base64_encode($sp31b9af); } function aliqr_decrypt($spb67857, $sp64a7c3) { $spb67857 = base64_decode($spb67857); $sp64a7c3 = base64_decode($sp64a7c3); $spc2c51b = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), 1); $sp31b9af = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $sp64a7c3, $spb67857, MCRYPT_MODE_CBC); $sp31b9af = trim($sp31b9af); $sp31b9af = stripPKSC7Padding($sp31b9af); return $sp31b9af; } function addPKCS7Padding($spbfed9c) { $spbfed9c = trim($spbfed9c); $sp243be7 = mcrypt_get_block_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC); $spdf710a = $sp243be7 - strlen($spbfed9c) % $sp243be7; if ($spdf710a <= $sp243be7) { $spb0938a = chr($spdf710a); $spbfed9c .= str_repeat($spb0938a, $spdf710a); } return $spbfed9c; } function stripPKSC7Padding($spbfed9c) { $spbfed9c = trim($spbfed9c); $spb0938a = substr($spbfed9c, -1); $sp3b0bf9 = ord($spb0938a); if ($sp3b0bf9 == 62) { return $spbfed9c; } $spbfed9c = substr($spbfed9c, 0, -$sp3b0bf9); return $spbfed9c; }