<?php
require_once 'qpayMchUtil.class.php'; class QpayMchAPI { protected $url; protected $isSSL; protected $timeout; public function __construct($sp78f833, $spa332c6, $spa1cdba = 5) { $this->url = $sp78f833; $this->isSSL = $spa332c6; $this->timeout = $spa1cdba; } public function notify_params() { $sp1eeb26 = file_get_contents('php://input'); return QpayMchUtil::xmlToArray($sp1eeb26); } public function notify_verify($sp50fc45, $sp4d5cc2) { if (!isset($sp50fc45['sign'])) { return false; } $sp26d1d6 = QpayMchUtil::getSign($sp50fc45, $sp4d5cc2['mch_key']); return $sp26d1d6 === $sp50fc45['sign']; } public function req($sp50fc45, $sp4d5cc2) { $sp123706 = array(); $sp50fc45['mch_id'] = $sp4d5cc2['mch_id']; $sp50fc45['nonce_str'] = QpayMchUtil::createNoncestr(); $sp50fc45['sign'] = QpayMchUtil::getSign($sp50fc45, $sp4d5cc2['mch_key']); $sp1eeb26 = QpayMchUtil::arrayToXml($sp50fc45); if (isset($this->isSSL)) { $sp123706 = QpayMchUtil::reqByCurlSSLPost($sp1eeb26, $this->url, $this->timeout); } else { $sp123706 = QpayMchUtil::reqByCurlNormalPost($sp1eeb26, $this->url, $this->timeout); } return $sp123706; } }