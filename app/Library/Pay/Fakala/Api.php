<?php
namespace App\Library\Pay\Fakala; use App\Library\Pay\ApiInterface; class Api implements ApiInterface { private $url_notify = ''; private $url_return = ''; private $pay_id; public function __construct($spf46c5d) { $this->url_notify = SYS_URL_API . '/pay/notify/' . $spf46c5d; $this->url_return = SYS_URL . '/pay/return/' . $spf46c5d; $this->pay_id = $spf46c5d; } function goPay($spa9e109, $sp206d07, $sp89af34, $sp92f0c1, $sp28f24f) { if (!isset($spa9e109['gateway'])) { throw new \Exception('请填写gateway'); } if (!isset($spa9e109['api_id'])) { throw new \Exception('请填写api_id'); } if (!isset($spa9e109['api_key'])) { throw new \Exception('请填写api_key'); } include_once 'sdk.php'; $spb4266c = new \fakala($spa9e109['gateway'], $spa9e109['api_id'], $spa9e109['api_key']); $sp651d92 = strtolower($spa9e109['payway']); $spb4266c->goPay($sp651d92, $sp89af34, $sp206d07, 0, $sp28f24f, '', $this->url_return, $this->url_notify); } function verify($spa9e109, $spf8927a) { $spf53f48 = isset($spa9e109['isNotify']) && $spa9e109['isNotify']; include_once 'sdk.php'; $spb4266c = new \fakala($spa9e109['gateway'], $spa9e109['api_id'], $spa9e109['api_key']); if ($spf53f48) { $sp9610ab = $spb4266c->notify_verify(); } else { $sp9610ab = $spb4266c->return_verify(); } if ($sp9610ab) { $sp206d07 = $_REQUEST['out_trade_no']; $spbc3979 = $_REQUEST['total_fee']; $spe4c92c = $_REQUEST['order_no']; $spf8927a($sp206d07, $spbc3979, $spe4c92c); } return $sp9610ab; } }