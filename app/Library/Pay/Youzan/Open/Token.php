<?php
namespace App\Library\Pay\Youzan\Open; use Exception; class Token { private $clientId; private $clientSecret; private $accessToken; private $refreshToken; private static $requestUrl = 'https://open.youzan.com/oauth/token'; public function __construct($sp2dc34d, $sp01a0af, $spfab834 = null, $spa956e3 = null) { $this->clientId = $sp2dc34d; $this->clientSecret = $sp01a0af; $this->accessToken = $spfab834; $this->refreshToken = $spa956e3; } public function getToken($spcbde7f, $spa3a035 = array()) { $sp31ee10 = array(); $sp31ee10['client_id'] = $this->clientId; $sp31ee10['client_secret'] = $this->clientSecret; if ($spcbde7f === 'oauth') { $sp31ee10['grant_type'] = 'authorization_code'; $sp31ee10['code'] = $spa3a035['code']; $sp31ee10['redirect_uri'] = $spa3a035['redirect_uri']; } elseif ($spcbde7f === 'refresh_token') { $sp31ee10['grant_type'] = 'refresh_token'; $sp31ee10['refresh_token'] = $spa3a035['refresh_token']; } elseif ($spcbde7f === 'self') { $sp31ee10['grant_type'] = 'silent'; $sp31ee10['kdt_id'] = $spa3a035['kdt_id']; } elseif ($spcbde7f === 'platform_init') { $sp31ee10['grant_type'] = 'authorize_platform'; } elseif ($spcbde7f === 'platform') { $sp31ee10['grant_type'] = 'authorize_platform'; $sp31ee10['kdt_id'] = $spa3a035['kdt_id']; } return $this->parseResponse(Http::post(self::$requestUrl, $sp31ee10)); } private function parseResponse($spcf353a) { $sp94131d = json_decode($spcf353a, true); if (null === $sp94131d) { throw new Exception('response invalid, data: ' . $spcf353a); } return $sp94131d; } }