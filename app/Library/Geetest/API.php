<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spd82bcd) { $this->geetest_conf = $spd82bcd; } public static function get() { $spff9d99 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spc52aea = time() . rand(1, 10000); $spd4997e = $spff9d99->pre_process($spc52aea); $sp46dd86 = json_decode($spff9d99->get_response_str()); Session::put('gt_server', $spd4997e); Session::put('gt_user_id', $spc52aea); return $sp46dd86; } public static function verify($sp5d9767, $spe41c2f, $sp9134a6) { $spff9d99 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spc52aea = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp836ce6 = $spff9d99->success_validate($sp5d9767, $spe41c2f, $sp9134a6, $spc52aea); if ($sp836ce6) { return true; } else { return false; } } else { if ($spff9d99->fail_validate($sp5d9767, $spe41c2f, $sp9134a6)) { return true; } else { return false; } } } }