<?php
namespace App\Library\Geetest; use Illuminate\Support\Facades\Session; class API { private $geetest_conf = null; public function __construct($spa9e109) { $this->geetest_conf = $spa9e109; } public static function get() { $spf46c5d = config('services.geetest.id'); $spf74fd0 = config('services.geetest.key'); if (!strlen($spf46c5d) || !strlen($spf74fd0)) { return null; } $sp117ae2 = new Lib($spf46c5d, $spf74fd0); $spaef809 = time() . rand(1, 10000); $sp7a1202 = $sp117ae2->pre_process($spaef809); $sp5780b9 = json_decode($sp117ae2->get_response_str()); Session::put('gt_server', $sp7a1202); Session::put('gt_user_id', $spaef809); return $sp5780b9; } public static function verify($spc97eb8, $sp254ca9, $spf9a2dd) { $sp117ae2 = new Lib(config('services.geetest.id'), config('services.geetest.key')); $spaef809 = Session::get('gt_user_id'); if (Session::get('gt_server') == 1) { $sp9610ab = $sp117ae2->success_validate($spc97eb8, $sp254ca9, $spf9a2dd, $spaef809); if ($sp9610ab) { return true; } else { return false; } } else { if ($sp117ae2->fail_validate($spc97eb8, $sp254ca9, $spf9a2dd)) { return true; } else { return false; } } } }