<?php
namespace App\Http\Controllers\Shop; use Illuminate\Database\Eloquent\Relations\Relation; use Illuminate\Http\Request; use App\Http\Controllers\Controller; use App\Library\Response; class Product extends Controller { function get(Request $sp85ba11) { $sp7bb93d = (int) $sp85ba11->post('category_id'); if (!$sp7bb93d) { return Response::forbidden('请选择商品分类'); } $sp9a35dc = \App\Category::where('id', $sp7bb93d)->first(); if (!$sp9a35dc) { return Response::forbidden('商品分类未找到'); } if ($sp9a35dc->password_open && $sp85ba11->post('password') !== $sp9a35dc->password) { return Response::fail('分类密码输入错误'); } $sp0493ec = \App\Product::where('category_id', $sp7bb93d)->where('enabled', 1)->orderBy('sort')->get(); foreach ($sp0493ec as $spf85ebf) { $spf85ebf->setForShop(); } return Response::success($sp0493ec); } function verifyPassword(Request $sp85ba11) { $sp16cfd7 = (int) $sp85ba11->post('product_id'); if (!$sp16cfd7) { return Response::forbidden('请选择商品'); } $spf85ebf = \App\Product::where('id', $sp16cfd7)->first(); if (!$spf85ebf) { return Response::forbidden('商品未找到'); } if ($spf85ebf->password_open && $sp85ba11->post('password') !== $spf85ebf->password) { return Response::fail('商品密码输入错误'); } return Response::success(); } }